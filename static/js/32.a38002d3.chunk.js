(this["webpackJsonpmatx-react"]=this["webpackJsonpmatx-react"]||[]).push([[32],{1062:function(e,t,r){"use strict";r.r(t);var a=r(60),n=r(5),c=r(10),s=r(1),o=r(750),i=r(756),u=r(337),l=r(18),b=r(28),d=r(6),j=r(62),p=r(174),f=r(622),g=r(560),O=r(802),m=r(624),x=r(620),v=r(553),h=r(177),w=r(81),y=r(801),E=r.n(y),k=r(650),S=r(634),C=r(623),L=r(987),P=r(806),q=Object(L.a)({apiKey:"AIzaSyBJlqFxzjy_reUZPVgi_Gxe8JkOULU99hY",authDomain:"imagenestarjeta.firebaseapp.com",projectId:"imagenestarjeta",storageBucket:"imagenestarjeta.appspot.com",messagingSenderId:"106700635725",appId:"1:106700635725:web:9344bebb591461d83ee604",measurementId:"G-J7H9K7J0W9"}),_=Object(P.b)(q),D=function(){var e=Object(b.a)(Object(l.a)().mark((function e(t,r){return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){var n=t.name.split(".")[1],c=Date.now(),s="".concat(c,".").concat(n," "),o=Object(P.c)(_,"/".concat(r,"/").concat(s)),i=Object(P.d)(o,t);i.on("state_changed",(function(){}),(function(e){console.log("Error al cargar en firestorage: ",e),a({ok:!1,msg:e.message||"Error al cargar archivo",url:null})}),(function(){Object(P.a)(i.snapshot.ref).then((function(t){e({ok:!0,msg:"File was uploaded succesfully",url:t})}))}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),U=r(121),F=r.n(U),M=r(176),T=r(2),R=Object(h.a)(p.TextValidator)((function(){return{width:"95%",marginBottom:"16px"}})),A=function(){var e=Object(w.b)(),t=Object(M.a)().user;console.log(t);var r=Object(w.c)((function(e){return e.usuario})).usuarioPerfil,a=Object(s.useState)(r),o=Object(c.a)(a,2),i=o[0],h=o[1],y=i.nombre,L=i.apellido,P=i.correo,q=i.correo_recuperacion,_=(i.identificacion,i.tipo_identificacion,i.genero,i.tipo_usuario),U=(i.cod_pais,i.foto_perfil_url),A=(i.entidad_id,i.contacto),I=Object(s.useState)(!1),z=Object(c.a)(I,2),G=z[0],V=z[1],J=(t.role.subcategoria,"SOCIO"===t.role.categoria),B=t.id===r.id,W=Object(s.useState)({urlPreview:"",imgFile:""}),K=Object(c.a)(W,2),H=K[0],N=K[1];Object(s.useEffect)((function(){console.log("canEdit: ",J),console.log("mismoPerfil: ",B),console.log("Evaluacion: ",J||B),U&&N(Object(n.a)(Object(n.a)({},H),{},{urlPreview:U}))}),[]),Object(s.useEffect)((function(){var e=H.imgFile;e&&N(Object(n.a)(Object(n.a)({},H),{},{urlPreview:URL.createObjectURL(e)}))}),[H.imgFile]);var Y=function(e){h(Object(n.a)(Object(n.a)({},i),{},Object(d.a)({},e.target.name,e.target.value)))},Z=Object(k.a)({celular:(null===A||void 0===A?void 0:A.celular)||"",whatsapp:(null===A||void 0===A?void 0:A.whatsapp)||"",fijo:(null===A||void 0===A?void 0:A.fijo)||""}),$=Object(c.a)(Z,3),Q=$[0],X=$[1],ee=($[2],function(){var e=Object(b.a)(Object(l.a)().mark((function e(t){var r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=t.target.files[0])&&N(Object(n.a)(Object(n.a)({},H),{},{imgFile:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),te=function(){var t=Object(b.a)(Object(l.a)().mark((function t(){var r,a,c,s,o,u;return Object(l.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("Submit perfil"),t.prev=1,V(!0),r=H.urlPreview,a=H.imgFile,c={id:i.id,celular:Q.celular,whatsapp:Q.whatsapp,fijo:Q.fijo,correo_recuperacion:q},s=r,!a){t.next=12;break}return t.next=9,D(a,"foto_perfil");case 9:o=t.sent,u=o.url,s=u;case 12:c=Object(n.a)(Object(n.a)({},c),{},{foto_perfil_url:s}),console.log("Actualizada: ",c),e(Object(S.a)(c)),V(!1),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(1),F.a.fire("Error",t.t0.message,"error"),V(!1);case 22:case"end":return t.stop()}}),t,null,[[1,18]])})));return function(){return t.apply(this,arguments)}}();return Object(T.jsx)(j.i,{children:Object(T.jsx)(p.ValidatorForm,{onSubmit:te,children:Object(T.jsxs)(f.a,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[Object(T.jsx)(f.a,{item:!0,lg:3,md:3,children:Object(T.jsx)(g.a,{sx:{padding:1,height:"100%"},children:Object(T.jsxs)(u.a,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(T.jsxs)(O.a,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:Object(T.jsx)(m.a,{"aria-label":"photo",onClick:function(){document.querySelector("#fileSelector").click()},children:Object(T.jsx)(E.a,{})}),children:[Object(T.jsx)(x.a,{src:H.urlPreview,sx:{justifySelf:"center",cursor:"pointer",width:200,height:200}}),Object(T.jsx)("input",{id:"fileSelector",type:"file",name:"file",style:{display:"none"},onChange:ee,accept:"images/*"})]}),Object(T.jsxs)(u.a,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(T.jsxs)(v.a,{variant:"h6",textAlign:"center",children:[" ","".concat(y," ").concat(L)," "]}),Object(T.jsxs)(v.a,{variant:"p",children:[" ",_.categoria,"  "]})]})]})})}),Object(T.jsxs)(f.a,{item:!0,lg:4.5,md:4.5,sm:12,xs:12,children:[Object(T.jsx)(R,{type:"text",name:"nombre",id:"standard-basic",value:y,onChange:Y,label:"Nombre",validators:["required"],errorMessages:["Este campo es requerido"],disabled:!(J||B)}),Object(T.jsx)(R,{type:"text",name:"apellido",id:"standard-basic",value:L,onChange:Y,label:"Apellido",validators:["required"],errorMessages:["Este campo es requerido"],disabled:!(J||B)}),Object(T.jsx)(R,{type:"text",name:"correo",id:"standard-basic",value:P,onChange:Y,label:"Correo",validators:["required","isEmail"],errorMessages:["Este campo es requerido","Debe tener formato de email"],disabled:!(J||B)}),Object(T.jsx)(R,{type:"text",name:"correo_recuperacion",id:"standard-basic",value:q,onChange:Y,label:"Correo de recuperaci\xf3n",validators:["required","isEmail"],errorMessages:["Este campo es requerido","Debe tener formato de email"],disabled:!(J||B)})]}),Object(T.jsxs)(f.a,{item:!0,lg:4.5,md:4.5,sm:12,xs:12,children:[Object(T.jsx)(R,{type:"text",name:"celular",id:"standard-basic",value:Q.celular,onChange:X,label:"Celular",validators:["required","minStringLength: 10","maxStringLength: 10"],errorMessages:["Este campo es requerido","Debe tener 10 n\xfameros","Debe tener 10 n\xfameros"],disabled:!(J||B)}),Object(T.jsx)(R,{type:"text",name:"whatsapp",id:"standard-basic",value:Q.whatsapp,onChange:X,label:"Whatsapp",validators:["required","minStringLength: 10","maxStringLength: 10"],errorMessages:["Este campo es requerido","Debe tener 10 n\xfameros","Debe tener 10 n\xfameros"],disabled:!(J||B)}),Object(T.jsx)(R,{type:"text",name:"fijo",id:"standard-basic",value:Q.fijo,onChange:X,label:"Fijo",validators:["required","minStringLength: 9","maxStringLength: 9"],errorMessages:["Este campo es requerido","Debe tener 9 n\xfameros","Debe tener 9 n\xfameros"],disabled:!(J||B)}),Object(T.jsx)(C.a,{variant:"contained",color:"primary",type:"submit",sx:{backgroundColor:"#053d6b",width:"95%"},loading:G,disabled:!(J||B),children:"Actualizar"})]})]})})})},I=r(122),z=Object(h.a)(p.TextValidator)((function(){return{width:"100%",marginBottom:"16px"}})),G=function(){Object(w.b)();var e=Object(s.useState)(!1),t=Object(c.a)(e,2),r=t[0],a=t[1],o=Object(M.a)().logout,i=Object(s.useState)({password:"",repeatPassword:""}),j=Object(c.a)(i,2),f=j[0],O=j[1],m=f.password,x=f.repeatPassword;p.ValidatorForm.addValidationRule("isPasswordMatch",(function(e){return e===m}));var h=function(e){O(Object(n.a)(Object(n.a)({},f),{},Object(d.a)({},e.target.name,e.target.value)))},y=function(){var e=Object(b.a)(Object(l.a)().mark((function e(){var t,r,n,c,s;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(!0);case 2:return e.prev=2,e.next=5,Object(I.b)("usuario/password/cambiar",{password:m},"PUT");case 5:return t=e.sent,e.next=8,t.json();case 8:if(r=e.sent,n=r.data,c=r.message,s=r.status,console.log(n),200===s){e.next=17;break}return e.next=16,a(!1);case 16:return e.abrupt("return",F.a.fire("Error",c,"error"));case 17:return F.a.fire("Exito",c,"success"),e.next=20,a(!1);case 20:o(),e.next=26;break;case 23:return e.prev=23,e.t0=e.catch(2),e.abrupt("return",F.a.fire("Error",e.t0.message,"error"));case 26:case"end":return e.stop()}}),e,null,[[2,23]])})));return function(){return e.apply(this,arguments)}}();return Object(T.jsx)(u.a,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:Object(T.jsx)(u.a,{minWidth:"70%",sx:{padding:4,alignSelf:"center"},children:Object(T.jsx)(g.a,{sx:{display:"flex",justifyContent:"center",padding:2},children:Object(T.jsxs)(p.ValidatorForm,{onSubmit:y,children:[Object(T.jsx)(v.a,{sx:{padding:2},variant:"h5",children:"Cambiar contrase\xf1a"}),Object(T.jsx)(z,{name:"password",size:"small",type:"password",label:"Contrase\xf1a nueva",value:m,variant:"outlined",onChange:h,validators:["required","minStringLength:8","maxStringLength:25"],errorMessages:["La contrase\xf1a es obligatoria","Debe tener al menos 8 caracteres","La contrase\xf1adebe tener m\xe1ximo 25 caracteres"]}),Object(T.jsx)(z,{name:"repeatPassword",size:"small",type:"password",label:"Repita la contrase\xf1a",value:x,variant:"outlined",onChange:h,validators:["required","isPasswordMatch","minStringLength:8","maxStringLength:25"],errorMessages:["La contrase\xf1a es obligatoria","Las contrase\xf1as deben coincidir","Debe tener al menos 8 caracteres","La contrase\xf1adebe tener m\xe1ximo 25 caracteres"]}),Object(T.jsx)(C.a,{fullWidth:!0,variant:"contained",color:"primary",type:"submit",sx:{backgroundColor:"#053d6b"},loading:r,children:"Enviar"})]})})})})},V=r(159),J=r(17),B=["children","value","index"],W=function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}},K=function(e){var t=e.children,r=e.value,c=e.index,s=Object(a.a)(e,B);return Object(T.jsx)("div",Object(n.a)(Object(n.a)({role:"tabpanel",hidden:r!==c,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c)},s),{},{children:r===c&&Object(T.jsx)(u.a,{children:t})}))};t.default=function(){var e=Object(w.b)(),t=Object(M.a)().user,r=new URLSearchParams(Object(J.j)().search).get("idUsuario");Object(s.useEffect)((function(){if(console.log("idUsuario: ",r),e(Object(S.b)()),!r)return e(Object(S.h)(t.id));e(Object(S.h)(r))}),[r]);var a=Object(w.c)((function(e){return e.usuario.usuarioPerfil})),l=Object(s.useState)(0),b=Object(c.a)(l,2),d=b[0],j=b[1];return a?Object(T.jsxs)(u.a,{sx:{width:"100%",padding:"10px"},children:[Object(T.jsx)(u.a,{sx:{borderBottom:1,borderColor:"divider"},children:Object(T.jsxs)(o.a,{value:d,onChange:function(e,t){j(t)},"aria-label":"basic tabs example",children:[Object(T.jsx)(i.a,Object(n.a)({label:"Informaci\xf3n"},W(0))),Object(T.jsx)(i.a,Object(n.a)({label:"Contrase\xf1a"},W(1)))]})}),Object(T.jsx)(K,{value:d,index:0,children:Object(T.jsx)(A,{})}),Object(T.jsx)(K,{value:d,index:1,children:Object(T.jsx)(G,{})})]}):Object(T.jsx)(V.a,{})}},634:function(e,t,r){"use strict";r.d(t,"c",(function(){return u})),r.d(t,"i",(function(){return l})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return p})),r.d(t,"b",(function(){return f})),r.d(t,"a",(function(){return O})),r.d(t,"d",(function(){return m})),r.d(t,"f",(function(){return v})),r.d(t,"e",(function(){return w}));var a=r(18),n=r(28),c=r(122),s=r(121),o=r.n(s),i=r(39),u=function(e){return function(){var t=Object(n.a)(Object(a.a)().mark((function t(r){var n,s,o,i,u;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],t.prev=1,t.next=4,Object(c.b)("usuario/crear",e,"POST");case 4:return s=t.sent,t.next=7,s.json();case 7:if(o=t.sent,i=o.data,"23000"!==o.status){t.next=14;break}return n.push("El usuario con esa identificacion ya se encuentra registrado"),t.abrupt("return",{success:!1,messages:n});case 14:if(201===o.status){t.next=17;break}for(u in i)n.push(i[u][0]);return t.abrupt("return",{success:!1,messages:n});case 17:return t.abrupt("return",{success:!0,data:i});case 20:return t.prev=20,t.t0=t.catch(1),n.push(t.t0.message),t.abrupt("return",{success:!1,messages:n});case 24:case"end":return t.stop()}}),t,null,[[1,20]])})));return function(e){return t.apply(this,arguments)}}()},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(){var t=Object(n.a)(Object(a.a)().mark((function t(r){var n,s,i;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(c.b)("usuario/listar?page=".concat(e),{},"GET");case 3:return n=t.sent,t.next=6,n.json();case 6:s=t.sent,i=s.data,r(b({registros:i.data,totalRegistros:i.total})),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.log("Error al consultar usuarios: ",t.t0.message),o.a.fire("Error",t.t0.message,"error");case 15:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()},b=function(e){return{type:i.a.getUsuarios,payload:e}},d=function(){return function(){var e=Object(n.a)(Object(a.a)().mark((function e(t){var r,n,s;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(c.b)("codigos/listar",{},"GET");case 3:return r=e.sent,e.next=6,r.json();case 6:n=e.sent,s=n.data,t(j(s)),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log("Error al consultar los codigos de pais: ",e.t0.message),o.a.fire("Error",e.t0.message,"error");case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()},j=function(e){return{type:i.a.setCodigos,payload:e}},p=function(e){return function(){var t=Object(n.a)(Object(a.a)().mark((function t(r){var n,s,i,u;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(c.b)("usuario/ver/".concat(e),{},"GET");case 3:return n=t.sent,t.next=6,n.json();case 6:if(s=t.sent,i=s.data,u=s.message,200===s.status){t.next=12;break}return t.abrupt("return",o.a.fire("Error",u,"error"));case 12:r(g(i)),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),console.log("Error al traer perfil de usuario: ",t.t0.message);case 18:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}()},f=function(){return{type:i.a.cleanUsuarioPerfil}},g=function(e){return{type:i.a.setUsuarioPerfil,payload:e}},O=function(e){return function(){var t=Object(n.a)(Object(a.a)().mark((function t(r){var n,s,i;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(c.b)("usuario/actualizar/".concat(e.id),e,"PUT");case 3:return n=t.sent,t.next=6,n.json();case 6:if(s=t.sent,s.data,i=s.message,200===s.status){t.next=12;break}return t.abrupt("return",o.a.fire("Error",i,"error"));case 12:o.a.fire("Exito",i,"success"),r(p(e.id)),t.next=19;break;case 16:return t.prev=16,t.t0=t.catch(0),t.abrupt("return",o.a.fire("Error",t.t0.message,"error"));case 19:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e){return t.apply(this,arguments)}}()},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(){var t=Object(n.a)(Object(a.a)().mark((function t(r){var n,s,i;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(c.b)("acceso/listar?page=".concat(e),{},"GET");case 3:return n=t.sent,t.next=6,n.json();case 6:s=t.sent,i=s.data,r(x({registros:i.data,totalRegistros:i.total})),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.log("Error al consultar usuarios: ",t.t0.message),o.a.fire("Error",t.t0.message,"error");case 15:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()},x=function(e){return{type:i.a.getAccesosList,payload:e}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(){var t=Object(n.a)(Object(a.a)().mark((function t(r){var n,s,o;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(c.b)("registro-lote/listar?page=".concat(e),{},"GET");case 3:return n=t.sent,t.next=6,n.json();case 6:s=t.sent,o=s.data,r(h({registros:o.data,totalRegistros:o.total})),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log("Error al consultar usuarios: ",t.t0.message);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()},h=function(e){return{type:i.a.getAllLotes,payload:e}},w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(){var r=Object(n.a)(Object(a.a)().mark((function r(n){var s,o,i;return Object(a.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(c.b)("acceso/ver/".concat(e,"?page=").concat(t),{},"GET");case 3:return s=r.sent,r.next=6,s.json();case 6:if(o=r.sent,i=o.data,console.log(i),null!==i){r.next=11;break}return r.abrupt("return",n(E()));case 11:n(y({registros:i.data,totalRegistros:i.total})),r.next=17;break;case 14:r.prev=14,r.t0=r.catch(0),console.log("Error al consultar usuarios: ",r.t0.message);case 17:case"end":return r.stop()}}),r,null,[[0,14]])})));return function(e){return r.apply(this,arguments)}}()},y=function(e){return{type:i.a.getAccesosUser,payload:e}},E=function(){return{type:i.a.vaciarAccesos,payload:[]}}},650:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(6),n=r(5),c=r(10),s=r(1),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new RegExp("^[0-9]+$","i"),r=Object(s.useState)(e),o=Object(c.a)(r,2),i=o[0],u=o[1],l=function(e){var r=e.target;(t.test(r.value)||0===r.value.length)&&u(Object(n.a)(Object(n.a)({},i),{},Object(a.a)({},r.name,r.value)))},b=function(){u(e)};return[i,l,b]}}}]);